- name: Set patroni container name variable
  set_fact:
    patroni_container_name: patroni_container

- name: Create Docker network
  community.docker.docker_network:
    name: "{{ network_name }}"
    state: present
  ignore_errors: yes

- name: Start Oracle Linux 9 container
  community.docker.docker_container:
    name: "{{ patroni_container_name }}"
    image: rockylinux:9
    state: started
    restart_policy: always

- name: Install required packages in Oracle Linux container
  community.docker.docker_container_exec:
    container: "{{ patroni_container_name }}"
    command: >
      dnf install -y
      'https://repo.percona.com/yum/percona-release-latest.noarch.rpm' &&
      dnf install -y python3-etcd percona-haproxy percona-patroni